---
title: "Projeto Ministério da Saúde e Preço-Alimentos"
author: "Panosso A.R. & Oliveira J."
date: "19/02/2021"
output: html_document
---
# Entrada de dados

```{r, message=FALSE}
library(tidyverse)
library(corrplot)
library(ggpubr)
caminho <- "https://raw.githubusercontent.com/arpanosso/ministerio_saude_alimentos/main/dados/alcatra.txt"
alcatra <- read.table(caminho,h=TRUE,sep="\t")
glimpse(alcatra)
```

# Criando os períodos

Foi adicionada outra variável, período, definida como P1 para anos menores ou iguais que 2011 e P2 para os demais.

```{r}
alcatra <- alcatra %>% 
  mutate(periodo = ifelse(Ano <= 2010,"P1","P2"))
glimpse(alcatra)
```


# Gráfico ao longo do tempo para IPCA e Exportação Bovina

```{r}
coeff <- 100000000
alcatra %>%   
  ggplot(aes(x=Ano)) +
  geom_line( aes(y=IPCA, color = "IPCA")) + 
  geom_line( aes(y=ExpBovi  / coeff, color = "ExpBovi")) + 
  scale_y_continuous(
    name = "IPCA",
    sec.axis = sec_axis(~.*coeff, name="ExpBovi")
  ) +
  scale_colour_manual(values = c("blue", "red"))+
  geom_vline(xintercept = c(2011),lty=2)
```


# Análise de correlação

## Para o Período 1
```{r}
alcatra %>% 
  filter(Ano < 2011) %>% 
  select(-Ano, - periodo) %>% 
  cor()
```

## Para o Período 2
```{r}
alcatra %>% 
  filter(Ano >= 2011) %>% 
  select(-Ano,-periodo) %>% 
  cor()
```

# Análise de regressão linear para cada período

```{r}
alcatra %>% 
  ggplot(aes(x=ExpBovi, y=IPCA, color=as.factor(periodo))) +
  geom_point()+
  geom_smooth(method = "lm")+
  facet_wrap(~periodo,scales = "free")+
  labs(color="Períodos")
```

## Anova para o Periodo 1

A análise de regressão linear foi não significativa pelo teste F ao nível de 5% de probabilidadade (p=0.2751), indicando que não existe uma relação linear entre o IPCA e ExpBovi, denotado pelos baixos valor de R² (0.07704).

```{r}
da<-alcatra %>% 
  filter(Ano <= 2011)
mod <- lm(IPCA~ExpBovi, data=da)
summary.lm(mod)
```

## Anova para o Periodo 2

A análise de regressão linear foi significativa pelo teste F ao nível de 5% de probabilidadade (p=0.03073), indicando que existe uma relação linear entre o IPCA e ExpBovi, denotado pelos médios valor de R² (0.4964).

```{r}
da<-alcatra %>% 
  filter(Ano > 2011)
mod <- lm(IPCA~ExpBovi, data=da)
summary.lm(mod)
```


# Gráfico ao longo do tempo para IPCA e Preço em Reais

```{r}
coeff <- .5
alcatra %>%   
  ggplot(aes(x=Ano)) +
  geom_line( aes(y=IPCA, color = "IPCA")) + 
  geom_line( aes(y=pReais  / coeff, color = "Preço em Reais")) + 
  scale_y_continuous(
    name = "IPCA",
    sec.axis = sec_axis(~.*coeff, name="Preço em Reais")
  ) +
  scale_colour_manual(values = c("blue", "red"))+
  geom_vline(xintercept = c(2011),lty=2)
```


# Análise de correlação

## Para o Período 1
```{r}
alcatra %>% 
  filter(Ano < 2011) %>% 
  select(-Ano, - periodo) %>% 
  cor()
```

## Para o Período 2
```{r}
alcatra %>% 
  filter(Ano >= 2011) %>% 
  select(-Ano,-periodo) %>% 
  cor()
```

# Análise de regressão linear para cada período

```{r}
alcatra %>% 
  ggplot(aes(x=pReais, y=IPCA, color=as.factor(periodo))) +
  geom_point()+
  geom_smooth(method = "lm")+
  facet_wrap(~periodo,scales = "free")+
  labs(color="Períodos")
```

## Anova para o Periodo 1

A análise de regressão linear foi não significativa pelo teste F ao nível de 5% de probabilidadade (p= 0.8714), indicando que não existe uma relação linear entre o IPCA e pReais, denotado pelos baixos valor de R² (0.005774).

```{r}
da<-alcatra %>% 
  filter(Ano <= 2011)
mod <- lm(IPCA~pReais, data=da)
summary.lm(mod)
```

## Anova para o Periodo 2

A análise de regressão linear foi significativa pelo teste F ao nível de 5% de probabilidadade (p=0.2252), indicando que existe uma relação linear entre o IPCA e pReais, denotado pelos baixos valor de R² (0.2334).

```{r}
da<-alcatra %>% 
  filter(Ano > 2011)
mod <- lm(IPCA~pReais, data=da)
summary.lm(mod)
```

# Rodada de análise 2

```{r}
caminho <- "https://raw.githubusercontent.com/arpanosso/ministerio_saude_alimentos/main/dados/rodada2.txt"
ipca <- read.table(caminho,h=TRUE,sep="\t")
glimpse(ipca)
```

```{r}
coeff <- 1
ipca %>%   
  ggplot(aes(x=Ano)) +
  geom_line( aes(y=IPCA, color = "IPCA")) + 
  geom_line( aes(y=pExp   / coeff, color = "pExp")) + 
  scale_y_continuous(
    name = "IPCA",
    sec.axis = sec_axis(~.*coeff, name="pExp")
  ) +
  scale_colour_manual(values = c("blue", "red"))+
  geom_vline(xintercept = c(2011),lty=2)
```
# Análise de correlação

## Para o Período TOTAL
```{r}
ipca %>% 
  select(-Ano) %>% 
  cor()
```


# Análise de regressão linear para cada período

```{r,message=FALSE}
ipca %>% 
  ggplot(aes(x=pExp, y=IPCA)) +
  geom_point()+
  geom_smooth(method = "lm")
```

## Anova para o Periodo TOTAL

A análise de regressão linear foi  significativa pelo teste F ao nível de 15% de probabilidadade (p= 1.63e-09), indicando que  existe uma relação linear entre o IPCA e pExp, denotado pelos alto valor de R² (0.944).

```{r}

mod <- lm(IPCA~pExp, data=ipca)
summary.lm(mod)
```

# Rodada 3

```{r}
caminho <- "https://raw.githubusercontent.com/arpanosso/ministerio_saude_alimentos/main/dados/rodada3.txt"
dados <- read.table(caminho,h=TRUE,sep="\t")
glimpse(dados)
```


# Gráfico ao longo do tempo para IPCA e oleo_soja_exp

```{r}
coeff <- 1
dados %>%   
  ggplot(aes(x=ano)) +
  geom_line( aes(y=IPCA, color = "IPCA")) + 
  geom_line( aes(y=oleo_soja_exp  / coeff, color = "oleo_soja_exp")) + 
  scale_y_continuous(
    name = "IPCA",
    sec.axis = sec_axis(~.*coeff, name="oleo_soja_exp")
  ) +
  scale_colour_manual(values = c("blue","red"))
```

# Gráfico ao longo do tempo para IPCA e grao_soja_exp

```{r}
coeff <- 1
dados %>%   
  ggplot(aes(x=ano)) +
  geom_line( aes(y=IPCA, color = "IPCA")) + 
  geom_line( aes(y=grao_soja_exp  / coeff, color = "grao_soja_exp")) + 
  scale_y_continuous(
    name = "IPCA",
    sec.axis = sec_axis(~.*coeff, name="grao_soja_exp")
  ) +
  scale_colour_manual(values = c("red", "blue"))
```




# Análise de correlação

```{r}
dados %>% 
  select(-ano) %>% 
  cor()
```
# Análise de regressão linear para óleo de soja 

```{r}
dados %>% 
  ggplot(aes(x=oleo_soja_exp, y=IPCA)) +
  geom_point(shape=21, color="black", fill="aquamarine4", size=4)+
  geom_smooth(aes(x=oleo_soja_exp, y=IPCA),method = "lm",color="red") +
  theme_classic()+
  stat_regline_equation(aes(
  label =  paste(..eq.label.., ..rr.label.., sep = "*plain(\",\")~~")))
```

## Anova para óleos de soja

A análise de regressão linear foi significativa pelo teste F ao nível de 1% de probabilidadade (p=<0.001), indicando que existe uma relação linear entre o IPCA e oleo_soja_exp, denotado pelos altos valor de R² (0.92).

```{r}
da<-dados
mod <- lm(IPCA~oleo_soja_exp, data=da)
summary.lm(mod)
```

# Análise de regressão linear para grao de soja 

```{r}
dados %>% 
  ggplot(aes(x=grao_soja_exp, y=IPCA)) +
  geom_point(shape=21, color="black", fill="aquamarine4", size=4)+
  geom_smooth(aes(x=oleo_soja_exp, y=IPCA),method = "lm",color="red") +
  theme_classic()+
  stat_regline_equation(aes(
  label =  paste(..eq.label.., ..rr.label.., sep = "*plain(\",\")~~")))
```

## Anova para grãos de soja

A análise de regressão linear foi significativa pelo teste F ao nível de 1% de probabilidadade (p<0.001), indicando que existe uma relação linear entre o IPCA e grao_soja_exp, denotado pelos altos valor de R² (0.85).

```{r}
da<-dados
mod <- lm(IPCA~grao_soja_exp, data=da)
summary.lm(mod)
```
